# Unknown Info Stealer Distributed via Compromised Discord Accounts

Observed ITW on 2022-01-29, possibly distributed as early as 2022-01-28.

## Campaign Details

![Campaign graph](./graph.png)

This campaign is distributed via compromised Discord accounts. The compromised account sends a message to other accounts, claiming that they've made a new game and would like the target to try it out.

The message contains a link to `hxxps://helper-cat[.]com`:

![helper-cat homepage](./helpercat-1.png)

The download link on the page leads to `hxxps://helper-cat[.]com/attachments/916372126548787201/919546730075283516/helpercatmygames.rar` (which looks suspiciously like a Discord attachment URL). This RAR file is 8b1598d40d1ecad92b502aad1035cef8 ([VT](https://www.virustotal.com/gui/file/3cf0778cb0a2f50f92a3fda14837699cd7e6532e33a5d35e125a20db8fe87b3a), [MB](https://bazaar.abuse.ch/sample/3cf0778cb0a2f50f92a3fda14837699cd7e6532e33a5d35e125a20db8fe87b3a/)), and contains a PE called `helpercatmygames.exe`.

This malicious PE is fc54e853683c124579ed64963c5ab98f ([VT](https://www.virustotal.com/gui/file/babf526ebe596643961a64b67dea3846f45355f4852f560046f06b633141b2a3), was too big for MB), and contains a node.js runtime and some malicious Javascript code, suspected to be obfuscated with [javascript-obfuscator](https://github.com/javascript-obfuscator/javascript-obfuscator). The original code is available [here](./mal_code.js), and a partially deobfuscated version of the code is available [here](./mal_code_deob.js).

Running the sample on Hatching Triage ([report](https://tria.ge/220130-bysxzacgan/behavioral2)) shows the malware grabbing the victim system's IP address (could be country as well, ipconfig.io has a few different useful endpoints), and then likely uploading stolen credentials/tokens to `hxxps://indianboatparty.com`

![Triage TCP connections](./triage-1.png)

The stealer targets at least these different software products (not necessarily an exhaustive list, only triage-level analysis was performed):
* Google Chrome
* Discord
* Discord Canary
* BetterDiscord
* Microsoft Edge
* Yandex Browser

## IOCs

Domains:
```
helper-cat.com
indianboatparty.com
```

IPs:
```
185.174.136.84
```

Hashes:
```
8b1598d40d1ecad92b502aad1035cef8
fc54e853683c124579ed64963c5ab98f
```